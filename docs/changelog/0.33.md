# IcyDB 0.33

This document aggregates detailed release notes for the `0.33.x` minor line.

---

## 0.33.3 - 2026-02-28 - Load Terminal Dispatch Consolidation and Commit Recovery Hardening

### ğŸ“ Summary

0.33.3 reduces structural growth pressure in the session layer by collapsing thin load-terminal wrappers into one shared session execution primitive while preserving terminal behavior and fluent-call ergonomics. It also hardens commit-marker recovery by clarifying replay/index-rebuild responsibilities and tightening replay compatibility checks.

### ğŸ”§ Changed - Load Terminal Dispatch

- Removed the large set of one-method-per-terminal load wrappers from the session layer and kept one shared load-query execution helper as the execution boundary.
- Moved terminal-specific operation dispatch to the fluent load query terminals, where each terminal now supplies its executor closure directly through the shared execution helper.
- Preserved metrics wiring, plan construction, and query-error mapping behavior by continuing to route all terminals through the same session-owned execution primitive.

### ğŸ”§ Changed - Commit Recovery

- Added a commit schema fingerprint on marker row operations and enforced replay-time compatibility checks so marker replay fails closed when runtime schema/index contracts drift.
- Updated recovery ordering to clear the persisted marker only after secondary-index rebuild succeeds, so rebuild failures keep marker authority for retry.
- Split prepared-op application semantics so recovery replay now applies row mutations only, while secondary indexes are rebuilt once from authoritative row state.
- Added a replay-specific row-only rollback snapshot path so recovery rollback scope matches recovery apply scope.
- Annotated forward and reverse index mutations with typed delta kinds and derived commit-window mutation summaries from those annotations.
- Simplified commit-memory owner resolution to select the first matching registry range owner under the non-overlap registry contract.

### ğŸ§­ Migration Notes

- Public fluent load terminal methods and return contracts are unchanged.
- This release is expected to be behavior-preserving and focused on internal API-surface consolidation for maintainability.
- Newly persisted markers include a schema fingerprint; legacy markers without one remain replayable.
- Recovery behavior is stricter under schema drift and may now reject incompatible pending markers instead of attempting planner re-derivation.

### ğŸ§ª Testing

- Split the aggregate executor parity suite into focused matrix modules while preserving terminal-parity coverage across session and executor entry paths.
- Added recovery coverage that rejects marker replay on schema-fingerprint mismatch and keeps marker state persisted for retry.
- Expanded startup recovery assertions to require marker persistence when rebuild fails closed.

---

## 0.33.2 - 2026-02-28 - Grouped Runtime Activation and Stream Ownership Cleanup

### ğŸ“ Summary

0.33.2 completes grouped query runtime activation while continuing the `db/` structural compression program. The release finalizes grouped execution flow, grouped cursor resume wiring, and stream ownership boundaries without redesigning the existing query-to-executor architecture.

### ğŸ”§ Changed - Grouped Vertical Slice Activation

- Activated grouped execution in load runtime so grouped plans are executed rather than rejected through temporary unsupported paths.
- Wired grouped aggregation state accumulation and finalization into grouped page materialization.
- Extended session execution and response plumbing so grouped queries can execute through the public session surface.

### ğŸ”§ Changed - Cursor and Resume Wiring

- Connected grouped continuation token decode, validation, and preparation into grouped load entry paths.
- Enforced grouped resume revalidation so resumed execution continues strictly after the last emitted grouped boundary.
- Unified pagination response handling to support both scalar and grouped cursor payloads under one response contract.

### ğŸ”§ Changed - Route and Observability Alignment

- Corrected grouped route observability to report real grouped route outcomes (selected, rejected, materialized fallback) and rejection reasons.
- Removed stale grouped-disabled diagnostics that no longer matched runtime behavior.

### ğŸ”§ Changed - Structural Compression

- Moved thin traversal helpers under executor ownership to keep physical traversal policy local to execution.
- Collapsed thin grouped planning relay modules so grouped handoff contracts are owned directly by query planning modules.
- Flattened grouped cursor scaffolding so grouped token and planned cursor contracts remain with their primary cursor owners.

### ğŸ”§ Changed - Stream Subsystem Ownership

- Moved the production DISTINCT stream adapter into the executor stream subsystem so production stream traits and implementations are co-located.
- Kept kernel focused on stream decoration/orchestration while consuming stream implementations from the stream subsystem.
- Preserved test-only stream mocks in test modules.

### ğŸ”§ Changed - Contracts and Boundaries

- Introduced neutral resolved-predicate contracts to prevent index compilation from depending on query-runtime internals.
- Preserved layer direction and executor/query contract boundaries while relocating ownership.

### ğŸ§­ Migration Notes

- Grouped queries are now executable through the session surface and return grouped continuation cursors.
- Cursor wire formats and aggregate semantics remain unchanged.
- This release is expected to be behavior-preserving for scalar query flows.

### ğŸ§ª Testing

- Re-ran workspace checks and tests to validate grouped-runtime wiring and structural moves.
- Compile-fail grouped session-missing guards were removed because grouped session execution is now available by design.
- Clippy execution may require an environment that supports hard-link operations for incremental artifacts.

---

## 0.33.0 - 2026-02-27 - Grouped Plan Activation

### ğŸ“ Summary

0.33.0 advances GROUP BY integration by hardening planner-level separation between scalar and grouped intent, tightening grouped execution boundaries, and normalizing governance/audit contracts used to track architectural drift.

### ğŸ”§ Changed - Architectural Changes

- Introduced a strict logical-plan split where grouped intent is represented as a dedicated grouped variant rather than an optional scalar-plan extension.
- Removed the temporary grouped wrapper plan carrier and consolidated grouped metadata flow through the canonical access-planned query model.
- Normalized audit governance structure into recurring domain ownership (`planner`, `executor`, `cursor`, `access`, `storage`, `invariants`, `contracts`) plus crosscutting and oneoff tracks.
- Migrated historical audit material into the normalized audit hierarchy while preserving append-only history.

### ğŸ”§ Changed - Execution Changes

- Executor entry points now pattern-match scalar and grouped logical plans explicitly.
- Grouped logical plans are routed through an explicit grouped-not-enabled path instead of implicit scalar fallback behavior.
- Grouped handoff wiring and route-planning integration now consume grouped plan metadata directly from the canonical planned-query boundary.

### ğŸ”§ Changed - Validation and Invariants

- Group-query validation now validates grouped semantics against grouped logical-plan state instead of wrapper-only carriers.
- Planner and executor boundaries now enforce a stricter invariant: grouped semantics must remain type-level and must not be represented as transient scalar plan state.
- Audit governance now requires domain-owned recurring audits and day-grouped report retention to preserve invariant telemetry continuity.

### ğŸ”§ Changed - Error Model Changes

- Added grouped-plan-required validation signaling for paths that attempt grouped validation without grouped logical-plan state.
- Preserved explicit grouped unsupported execution rejection during gated runtime phases to avoid silent fallback semantics.

### ğŸ§­ Migration Notes

- This release changes internal planning and execution contracts around grouped intent; downstream integrations relying on internal plan carriers must align to the grouped logical-plan variant boundary.
- Grouped runtime execution remains intentionally gated; grouped plan construction and validation are activated ahead of runtime enablement.
- Audit and governance documentation paths are normalized; automation should use the new audit hierarchy and day-grouped reports convention.

### ğŸ§ª Testing

- Expanded grouped route/planner contract coverage for grouped logical-plan transport and handoff consistency.
- Expanded grouped validation coverage around grouped-plan-required enforcement and grouped semantic rejection boundaries.
- Retained compile-fail and boundary tests that ensure grouped internals remain non-public and grouped runtime APIs stay gated until full enablement.
- Re-ran core crate tests to confirm grouped planning contract changes preserve scalar-path behavior while grouped runtime remains blocked.
