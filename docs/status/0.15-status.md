# 0.15 Status (as of 2026-02-19)

## 0.15 Scope

This status tracks progress against `docs/design/0.15-ordered-key-stream.md`
for the `0.15.x` internal ordered-key stream abstraction milestone.

In scope for `0.15`:

- Introduce a unified internal ordered key stream abstraction
- Replace direct `Vec<DataKey>` access-path outputs with stream production
- Keep continuation and limit semantics in existing executor/cursor layers
- Preserve public API and query behavior

Out of scope for `0.15`:

- Public streaming API
- Async execution
- Composite access execution (`Union` / `Intersection`)
- Semantic relocation of cursor/limit logic

---

## Release Snapshot

- [ ] `0.15.0` not released
- [x] `OrderedKeyStream` abstraction introduced in runtime execution paths
- [x] Access-path key production no longer returns `Vec<DataKey>` directly
- [x] Load executor consumes key streams directly
- [x] 0.14 continuation/DESC/limit regression baseline remains green
- [x] Explain-surface regression baseline remains green
- [x] Metrics-surface regression baseline remains green

Overall status for 0.15 tracked work: **100% complete**.

---

## 0.15 Plan Alignment (Ordered Key Stream Abstraction)

### 1. Core Abstraction (`OrderedKeyStream`)

- Progress: **100%**
- Done:
  - Added internal `OrderedKeyStream` trait with fallible pull-based key
    retrieval (`next_key`).
  - Added `VecOrderedKeyStream` adapter for mechanically wrapping existing
    vector-producing implementations.
  - Added focused unit tests for stream ordering and exhaustion behavior.
- Remaining:
  - No open abstraction gaps for 0.15 scope.

### 2. Access-Path Key Production Surface

- Progress: **100%**
- Done:
  - Replaced `AccessPath` key production API with stream production
    (`produce_key_stream`).
  - Replaced `AccessPlan` key production API with stream production for path,
    union, and intersection shapes.
  - `Context` now exposes stream-based access/plan key-resolution entrypoints.
- Remaining:
  - No open access-surface gaps for 0.15 scope.

### 3. Executor Integration

- Progress: **100%**
- Done:
  - Load executor fallback path now requests one stream from context and
    consumes it through shared materialization phases.
  - Fast paths (`pk_stream`, `secondary_index`, `index_range_limit`) now return
    stream-backed results via `VecOrderedKeyStream`.
  - Shared post-access phases (`finalize_rows_into_page`,
    `finalize_path_outcome`) remain unchanged semantically.
- Remaining:
  - No open executor-integration gaps for 0.15 scope.

### 4. Invariant/Behavior Preservation

- Progress: **100%**
- Done:
  - Existing continuation, DESC, limit-pushdown, explain, and metrics behavior
    remained green across regression suites.
  - Added explicit `by_ids` duplicate-input regression coverage to lock
    de-dup behavior under stream-backed key production.
- Remaining:
  - No known invariant regressions in current tree.

### 5. 0.15 Completion Criteria Check

- [x] No access path returns `Vec<DataKey>` directly
- [x] All load paths produce `OrderedKeyStream`
- [x] Executor consumes stream
- [x] 0.14 continuation tests pass
- [x] DESC tests pass
- [x] Limit pushdown tests pass
- [x] No explain output regressions in test suite
- [x] No metrics regressions in test suite

---

## Verification Run (this status pass)

- `cargo check --workspace --locked`
  - Result: pass
- `cargo test -p icydb-core --locked`
  - Result: `549 passed; 0 failed`
- `cargo test --workspace --locked`
  - Result: pass across workspace unit/integration/compile-fail/doc tests
- `cargo test -p icydb-core db::executor::tests::semantics --locked`
  - Result: `20 passed; 0 failed`
- `cargo test -p icydb-core db::executor::ordered_key_stream --locked`
  - Result: `2 passed; 0 failed`

Clippy note:

- `cargo clippy -p icydb-core --all-targets --locked -- -D warnings` is blocked
  in this environment by filesystem hard-link/cross-device errors
  (`Invalid cross-device link (os error 18)`), not code-level lint findings.

---

## Readout

- 0.15 is complete as a structural internal refactor: ordered-key production is
  now unified behind a stream contract and consumed by load execution.
- Semantic ownership remains unchanged (cursor/limit/post-access still owned by
  existing executor/cursor layers), which matches the designâ€™s non-relocation
  principle.
- Existing behavior and regression baselines remained stable through the change.

---

## Next Checkpoint

1. Cut `0.15.0` once release hygiene is complete.
2. Start `0.16` planning for stream-level continuation/limit ownership transfer
   (without regressing the now-stream-backed 0.15 baseline).
