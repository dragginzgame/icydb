# 0.22 Status (as of 2026-02-20)

## 0.22 Scope

This status tracks streaming aggregates from:

- `docs/design/0.22-streaming-aggregates.md`

In scope for `0.22`:

- load-query aggregate terminals: `count`, `exists`, `min`, `max`
- primary-key aggregate semantics for `min`/`max` (`Option<Id<E>>`)
- aggregate execution through the same key-stream routing path used by load execution
- aggregate parity with DISTINCT and page windows (`offset`/`limit`)

Out of scope for `0.22`:

- `SUM`, `AVG`, `COUNT DISTINCT`, `GROUP BY`
- field-value aggregates (for example `MIN(price)`)
- cursor-paged aggregate API
- COUNT pushdown optimization (planned for `0.22.1+`)

---

## Release Snapshot

- [ ] `0.22.0` not released
- [x] Milestone tracker created
- [x] Session aggregate terminals added (`count`, `exists`, `min`, `max`)
- [x] Load executor aggregate path added (streaming + fallback)
- [x] Shared streaming-safety gate added in `LogicalPlan`
- [x] Direction-aware `MIN`/`MAX` behavior added for ordered streams
- [x] Aggregate parity coverage expanded across key path families
- [x] COUNT pushdown subset guard added for post-`0.22.0` work

Overall status: **in progress; core 0.22 feature scope is implemented and passing targeted parity tests**.

---

## Current Baseline

- Aggregate terminals are wired on `SessionLoadQuery`.
- Aggregate execution reuses load key-stream routing and DISTINCT wrapping.
- Streaming eligibility is centralized to avoid drift between aggregate and load execution rules.

```text
count_pushdown_eligible âŠ† streaming_aggregate_eligible
```

---

## Next Slice

1. Run full workspace regression/lint gate for release readiness.
2. Finalize `0.22.0` release notes and cut release.
3. `0.22.1`: finish COUNT pushdown on top of the existing shared streaming-safety gate.
4. `0.23.0`: convert physical access paths to iterator-backed ordered streams.
5. `0.24.0`: add aggregate-aware fast-path variants where they are semantics-safe.

---

## Verification Run (this pass)

- `cargo fmt --all` (pass)
- `cargo check -p icydb-core` (pass)
- `cargo test -p icydb-core aggregate_parity -- --nocapture` (pass)
- `cargo test -p icydb-core session_load_aggregate_terminals_match_execute -- --nocapture` (pass)
