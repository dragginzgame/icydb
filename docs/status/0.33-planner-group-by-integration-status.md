# 0.33 Status (as of 2026-02-28)

## 0.33 Scope

This status tracks planner and `GROUP BY` integration work from:

- `docs/design/0.33-planner-group-by-integration.md`

`0.33` is the first release line that enables explicit grouped planning/execution
surfaces with additive APIs.

---

## In Scope (`0.33.x`)

- explicit `LogicalPlan` variant split (`Scalar` vs `Grouped`)
- grouped execution through explicit blocking grouped path
- grouped cursor protocol wiring (`GroupedContinuationToken` + resume/revalidate)
- grouped response surface extension (`Rows` vs `GroupedRows`)
- explicit session grouped API (`execute_grouped(...)`)
- grouped contract-spec freeze before runtime enablement

## Out of Scope (`0.33.x`)

- implicit grouped behavior through scalar APIs
- scalar/grouped return-type overloading or auto-detection
- grouped streaming/pushdown beyond blocking-first rollout
- cardinality-estimation-driven grouped planning policy (optional follow-up)

---

## Release Snapshot (`0.33.x`)

- [x] `0.33.0` released
- [x] `0.33.1` released
- [x] GROUP BY contract spec frozen (ordering, null semantics, equality, limits, cursor resume, error taxonomy)
- [x] Planner emits exclusive `LogicalPlan::{Scalar, Grouped}` variants
- [ ] Variant exclusivity/property tests added (no transitional/coerced states)
- [ ] Grouped blocking execution path enabled behind explicit grouped plan
- [x] Grouped cursor anchor semantics wired via `last_group_key` + offset compatibility checks
- [ ] Grouped response variant surfaced and scalar response contracts preserved
- [ ] Session grouped API added (`execute_grouped(...)`) without scalar API leakage
- [x] Changelog entry added for `0.33.0`

Current `0.33.x` status: **in progress (`0.33.1` shipped; `0.33.2` is the next enablement cut).**

### Target for `0.33.2`

- enable grouped blocking execution beyond the current explicit unsupported runtime gate
- surface grouped response variant(s) without scalar contract regression
- add explicit session grouped execution API (`execute_grouped(...)`)
- complete remaining grouped plan/response exclusivity coverage

---

## Phase Tracker

### Phase 0 - Contract Freeze

- [x] GROUP BY contract spec document created and reviewed
- [x] Ordering/null/equality/limit/cursor/error semantics approved

### Phase 1 - Planner Variant Split

- [x] `LogicalPlan::Scalar` and `LogicalPlan::Grouped` split implemented
- [x] Planner emits grouped variant only for grouped intent
- [x] Explain boundaries keep explicit scalar/grouped variant distinction

### Phase 2 - Response Surface

- [ ] Grouped response variant added
- [x] Scalar response contracts unchanged and non-implicit

### Phase 3 - Grouped Execution Path

- [ ] Grouped blocking reducer path enabled
- [ ] Deterministic grouped finalization preserved
- [ ] Group budget enforcement behavior aligned with frozen contract
- [x] Grouped route/handoff path is wired and intentionally rejects at runtime until response/API enablement lands

### Phase 4 - Grouped Cursor Protocol

- [x] Grouped cursor encode/decode/revalidate wired end-to-end
- [x] Resume token shape anchored by `last_group_key` semantics (not offset-only)

### Phase 5 - Session API

- [ ] `execute_grouped(...)` surfaced on session boundary
- [x] Scalar API boundary guards remain intact

---

## Exit Criteria (`0.33`)

`0.33` is complete when all are true:

1. grouped intent is represented by explicit grouped plan variants only
2. grouped execution is reachable only through grouped APIs and response variants
3. grouped cursor resume is anchor-based and contract-tested
4. scalar API behavior remains additive and unchanged
5. grouped contract semantics are documented and test-covered

---

## Verification Readout (Current)

Current implementation status: grouped plan/cursor substrate is landed; grouped runtime response and explicit session API remain gated for `0.33.2`.

Recommended verification sequence for `0.33.2` progress:

- `cargo check -p icydb-core`
- `cargo test -p icydb-core query::plan:: -- --nocapture`
- `cargo test -p icydb-core grouped_ -- --nocapture`
- `cargo test -p icydb-core --test compile_fail -- --nocapture`
- `cargo test -p icydb-core`
