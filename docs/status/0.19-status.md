# 0.19 Status (as of 2026-02-20)

## 0.19 Scope

This status tracks mixed-direction `ORDER BY` support from:

- `docs/design/0.19-mixed-direction-ordering.md`

In scope for `0.19`:

- comparator-centric ordering flow across executor stream combinators
- mixed-direction pagination correctness
- mixed-direction continuation correctness
- composite `Union`/`Intersection` correctness under mixed ordering

Out of scope for `0.19`:

- storage format changes
- cursor token format changes
- cost-based planning
- planner redesign

---

## Release Snapshot

- [ ] `0.19.0` not released
- [x] Milestone tracker created
- [x] Stream combinator internals moved to comparator-driven key comparisons
- [x] Comparator source seam added at fallback stream boundary (`OrderSpec`-aware helper with safety fallback)
- [x] Mixed-direction continuation/resume matrix completed (expanded two-field + three-field boundary coverage)
- [x] Mixed-direction composite permutation matrix completed (expanded mixed order + page-limit coverage)
- [x] Full 0.12–0.18 regression suite re-run and green

Overall status: **0.19 implementation and regression verification are complete; release cut remains**.

---

## Completed In This Pass

### 1. Comparator-Centric Stream Primitive

- Progress: **initial slice complete**
- Current state:
- Added `KeyOrderComparator` to `db::executor::ordered_key_stream`.
- Replaced direct direction branching in merge/intersection selection and monotonic checks with comparator calls.
- Preserved current behavior for uniform ASC/DESC paths.

### 2. Behavioral Verification

- Progress: **completed for touched paths**
- Current state:
- Existing ordered key stream unit suite remains green.
- Mixed-direction pushdown eligibility trace test remains green.

### 3. Comparator Source Wiring

- Progress: **initial slice complete**
- Current state:
- Fallback composite stream construction now receives an explicit key comparator from one `OrderSpec`-aware helper.
- Helper currently keeps comparator aligned with traversal direction when derived direction would diverge, so existing stream monotonicity invariants remain stable.

### 4. Mixed-Direction Resume Matrix

- Progress: **matrix completion slice complete**
- Current state:
- Added boundary-by-boundary mixed-direction resume coverage across:
- two-field order cases (`rank`, `id`) for all direction combinations
- three-field mixed-direction cases (`group`, `rank`, `id`)
- Added paged-vs-unbounded parity and no-duplicate assertions across page limits `1`, `2`, and `3`.

### 5. Continuation Comparator Helpers

- Progress: **initial slice complete**
- Current state:
- Replaced inline direction branching in cursor continuation advancement/rewrite with `DirectionComparator` helper methods.
- Cursor resume and strict "after anchor" checks now route through one comparator-owned path.

### 6. Mixed-Direction Composite Permutation Matrix

- Progress: **matrix expansion slice complete**
- Current state:
- Added mixed-direction child-order permutation invariance tests for `Union` and `Intersection`.
- Added matrix coverage across multiple mixed order patterns and page limits.
- Tests assert paged row sequence and continuation-boundary parity across child-plan reorderings for each matrix case.

---

## Next Slice

1. Cut `0.19.0` release.

---

## Verification Run (this pass)

- No additional compile/test runs were executed in this pass (per request).
- Full 0.12–0.18 regression sweep is now marked green (user-confirmed).
- `cargo fmt --all -- --check` (pass)
- `cargo check -p icydb-core` (pass)
- `cargo test -p icydb-core ordered_key_stream -- --nocapture` (pass)
- `cargo test -p icydb-core load_trace_marks_secondary_order_pushdown_outcomes -- --nocapture` (pass)
- `cargo test -p icydb-core load_composite_union_mixed_direction_fallback_preserves_order_and_pagination -- --nocapture` (pass)
- `cargo test -p icydb-core load_mixed_direction_resume_matrix_is_boundary_complete -- --nocapture` (pass)
- `cargo test -p icydb-core index_range_anchor_validation -- --nocapture` (pass)
- `cargo test -p icydb-core plan_cursor_rejects_index_range_boundary_anchor_mismatch -- --nocapture` (pass)
- `cargo test -p icydb-core load_union_child_order_permutation_preserves_rows_and_boundaries_under_mixed_direction -- --nocapture` (pass)
- `cargo test -p icydb-core load_intersection_child_order_permutation_preserves_rows_and_boundaries_under_mixed_direction -- --nocapture` (pass)
- `cargo test -p icydb-core permutation_matrix_preserves_rows_and_boundaries_under_mixed_direction -- --nocapture` (pass)
