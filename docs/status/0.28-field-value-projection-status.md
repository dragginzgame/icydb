# 0.28 Status (as of 2026-02-24)

## 0.28 Scope

This status tracks field-value projection terminals from:

- `docs/design/0.28-field-value-projection.md`

`0.28` is split into two tracks:

1. `0.28.0` core: projection semantics and structural terminal surface
2. `0.28.x` follow-up: value-distinct and ergonomic projection expansion

---

## 0.28.0 Core Track

### In Scope (`0.28.0`)

- ship `values_by(field) -> Vec<Value>` on load queries
- keep projection as a terminal transformation (no new query mode)
- keep parity contract: `values_by(field)` matches `execute()` field projection over the effective window
- keep projection slot-based (`resolved slot index`) and avoid runtime string lookup in projection loops
- preserve existing route ownership and load execution boundaries
- preserve non-paged terminal intent boundaries (cursor tokens rejected)

### Out of Scope (`0.28.0`)

- `distinct_values_by(field)` terminal
- typed projection wrappers/generics
- multi-field projection terminals
- projection pushdown or partial-row decode
- continuation/projection signature redesign
- `group_by`

### Release Snapshot (`0.28.0`)

- [x] `0.28.0` released
- [x] Design doc finalized (`docs/design/0.28-field-value-projection.md`)
- [x] Core terminal added (`values_by(field)`)
- [x] Session + facade wiring added for `values_by`
- [x] Parity tests added against `execute()` projection baseline
- [x] Row-level DISTINCT interaction test added (`values_by` may contain duplicate values from distinct rows)
- [x] Unknown-field fail-before-scan coverage added
- [x] Scan-budget parity coverage added versus `execute()`
- [x] Changelog entry added for `0.28.0`

Current `0.28.0` status: **released**.

---

## 0.28.x Follow-Up Track

### Target Items (`0.28.x`)

- `distinct_values_by(field)` as a value-level distinct terminal
- optional ergonomic terminals (`first_value_by`, `last_value_by`)
- optional id/value paired projection (`values_by_with_ids`)
- projection-core hardening for typed wrappers and multi-field terminals in `0.29+`

### Release Snapshot (`0.28.x`)

- [x] `distinct_values_by(field)` implemented in-tree (core + facade)
- [x] `values_by_with_ids(field)` implemented in-tree (core + facade)
- [x] `first_value_by(field)` implemented in-tree (core + facade)
- [x] `last_value_by(field)` implemented in-tree (core + facade)
- [x] `distinct_values_by` parity tests added against effective-window `execute()` projection
- [x] `values_by_with_ids` parity tests added against effective-window `execute()` projection
- [x] terminal-value parity tests added for `first_value_by` and `last_value_by`
- [x] Unknown-field fail-before-scan coverage extended for projection follow-up terminals
- [x] Scan-budget parity coverage added for `distinct_values_by` and `values_by_with_ids` versus `execute()`
- [ ] Patch release cut and publish metadata for next `0.28.x` version

### `distinct_values_by` Ship Gate

`distinct_values_by(field)` should only ship once all are locked:

1. comparator-driven DISTINCT behavior remains stable and test-locked
2. canonical ordering contract is preserved for projected output
3. pushdown/scan-budget invariants are parity-safe for any optimized path

Current recommendation: **defer from `0.28.0`, target `0.28.x`.**

---

## 0.28 Invariants

- projection runs after canonical effective row selection is finalized
- query-level `DISTINCT` remains row-level, not projection-value-level
- `values_by` introduces no new route branches and no resolver bypass
- projection semantics are keyed by resolved slot index
- scan-budget behavior stays parity-stable against equivalent `execute()` queries

---

## Verification Readout (Current)

Executed for this feature slice:

- `cargo fmt --all` (pass)
- `cargo check -p icydb -p icydb-core` (pass)
- `cargo test -p icydb-core values_by -- --nocapture` (pass)
- `cargo test -p icydb-core distinct_values_by -- --nocapture` (pass)
- `cargo test -p icydb-core aggregate_field_target_new_terminals_unknown_field_fail_without_scan -- --nocapture` (pass)
- `cargo test -p icydb --lib -- --nocapture` (pass)

Remaining before release cut:

- run full project release gate (`make fmt-check && make clippy && make check && make test`)
- cut and tag the next `0.28.x` patch version
