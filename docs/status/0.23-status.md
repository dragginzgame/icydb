# 0.23 Status (as of 2026-02-21)

## 0.23 Scope

This status tracks decimal consolidation from:

- `docs/design/0.23-decimalisation.md`

In scope for `0.23`:

- one owned runtime decimal engine (`Decimal { mantissa: i128, scale: u32 }`)
- collapse fixed-point runtime branching into a single decimal path
- delete `E8s` / `E18s` from schema/runtime surfaces
- add schema newtype wrappers for `E8s`/`E18s` fixed-scale compatibility
- remove all runtime reliance on `rust_decimal`
- enforce decimal scale at schema write boundaries

Out of scope for `0.23`:

- arbitrary-precision decimal math
- scientific notation parsing
- multiple rounding-mode families
- planner/cost-model redesign

---

## Release Snapshot

- [x] `0.23` milestone tracker created
- [x] `0.23` design doc rewritten into standard milestone format
- [x] schema pre-work landed for decimal scale declaration (`item(scale = N)`)
- [x] runtime field metadata carries decimal scale (transitional `Option<u32>` shape)
- [x] `Primitive::E8s` / `Primitive::E18s` removed from schema + derive surfaces
- [x] schema newtype wrappers landed for `E8s`/`E18s` compatibility
- [x] owned decimal arithmetic engine landed
- [x] `E8s`/`E18s` deleted from schema/runtime surfaces
- [x] zero runtime reliance on `rust_decimal` (dependency removed)
- [x] `Value` fixed-point variant collapse completed

Overall status: **in progress; decimal engine consolidation is complete and remaining work is boundary hardening**.

---

## Current Baseline

- Decimal scale can now be declared in schema macros with `item(prim = "Decimal", scale = N)`.
- Non-decimal primitives reject `scale` at derive validation time.
- Runtime model now preserves decimal scale metadata for downstream enforcement wiring.
- Schema primitives no longer include `E8s`/`E18s`; compatibility is wrapper-based.
- Base schema wrappers now exist for fixed-scale compatibility:
  - `base::types::finance::E8s` (`scale = 8`)
  - `base::types::finance::E18s` (`scale = 18`)
- Runtime numeric consolidation is now complete:
  - owned decimal implementation is active
  - `Value` fixed-point variants are collapsed to `Decimal`
  - `rust_decimal` dependency is removed

---

## Next Slice

1. Finalize write-time decimal scale enforcement using the transitional `FieldKind::Decimal { scale: Option<u32> }` model.
2. Remove transitional `Option<u32>` shape and move to required-scale model once planner/executor wiring is complete.
3. Add boundary tests for mixed-scale writes and decode-time rejection paths.
4. Run full aggregate/predicate parity verification against the new decimal path.

---

## Verification Run (this pass)

- `cargo test -p icydb-core decimal_serde_json_string_roundtrip -- --nocapture`
- `cargo test -p icydb-core canonical_tag_and_rank_are_stable -- --nocapture`
- `cargo test -p icydb-schema-tests test::validate::finance -- --nocapture`
- `cargo check -p icydb-core --quiet`
- `cargo check --workspace --quiet`
