# 0.16 Status (as of 2026-02-19)

## 0.16 Scope

This status tracks progress against `docs/design/0.16-composite-union.md`
for the `0.16.x` composite access execution milestone.

In scope for `0.16`:

- `AccessPath::Union` composite execution
- Planner emission for eligible `OR` shapes
- Executor N-way ordered stream merge
- Duplicate suppression across child paths
- ASC/DESC parity
- LIMIT/continuation compatibility without semantic relocation

Out of scope for `0.16`:

- `Intersection` execution
- Public streaming API
- Async execution
- Cost-based planner selection
- LIMIT pushdown across union children
- Cursor ownership relocation

---

## Release Snapshot

- [ ] `0.16.0` not released
- [x] 0.15 stream baseline is in place (`OrderedKeyStream` + stream-backed load paths)
- [x] Planner already emits and normalizes `AccessPlan::Union` for `OR` shapes
- [x] Internal `MergeOrderedKeyStream` helper exists with focused unit coverage
- [ ] Executor `Union` path uses stream merge (currently still materialized set collection)
- [ ] Explicit merge-direction enforcement is wired for composite execution
- [ ] 0.16 union regression matrix is complete

Overall status for tracked 0.16 work: **35% complete**.

---

## 0.16 Plan Alignment (Composite Union)

### 1. Planner Surface

- Progress: **80%**
- Current state:
- `AccessPlan::Union` emission for `OR` shapes exists in planner code.
- Union normalization/flattening support exists in planner normalization logic.
- Remaining:
- Complete 0.16-specific eligibility lock-in tests for the final emission constraints in the design doc.

### 2. Executor Integration

- Progress: **20%**
- Current state:
- `AccessPlan::Union` and `AccessPlan::Intersection` still resolve through candidate-key materialization (`collect_candidate_keys`) and are wrapped back into `VecOrderedKeyStream`.
- No stream-based N-way merge path is wired into composite execution yet.
- Remaining:
- Add union stream construction over child `OrderedKeyStream`s.
- Add pairwise merge composition to produce one canonical stream for load materialization.

### 3. Merge Primitive Readiness

- Progress: **60%**
- Current state:
- `MergeOrderedKeyStream` exists and covers ascending merge, descending merge, dedup, and error propagation in unit tests.
- Remaining:
- Wire merge primitive into production composite execution.
- Enforce design-level direction ownership checks when constructing composite merge streams.

### 4. Invariant and Ownership Boundaries

- Progress: **70%**
- Current state:
- Continuation, limit/offset, boundary validation, predicate filtering, and row deserialization ownership remain outside stream layer, consistent with 0.15 non-relocation.
- Remaining:
- Add union integration tests proving no semantic relocation under composite execution.

### 5. Completion Criteria Check

- [x] Planner can emit `Union`
- [ ] Executor supports N-way ordered merge for `Union`
- [ ] Direction is enforced at merge construction for composite execution
- [ ] Regression matrix is green for continuation, DESC parity, LIMIT behavior, explain surface, and metrics surface

---

## Verification Run (this status pass)

- Static code audit via `rg` across planner/executor stream callsites.
- Confirmed planner-side `Union` emission exists.
- Confirmed executor still materializes composite candidate keys in `context` path.
- Confirmed merge helper exists in ordered key stream module with dedicated tests.
- No full test suite rerun in this pass.

---

## Readout

- 0.16 has important groundwork in place, but composite execution is not yet implemented in the executor.
- The major remaining work is wiring `Union` to stream merge in production paths and then locking behavior with integration tests.
- Current baseline is safe: no semantic ownership moved into stream internals.

---

## Next Checkpoint

1. Implement executor-side stream composition for `AccessPlan::Union`.
2. Add explicit direction validation for composite merge construction.
3. Add union test matrix coverage (disjoint, overlap, empty-child, LIMIT, DESC, error cases).
4. Re-run targeted executor and pagination regression suites.
